<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, minimum-scale=1.0">
<title></title>


<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,500,500i,700,700i|Noto+Sans:400,400i,700,700i|Source+Code+Pro&amp;subset=latin-ext">
<link rel="stylesheet" href="/assets/css/custom_styles.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel="stylesheet" href="/doks-theme/assets/css/style.css">

	</head>
	<body class="green" data-spy="scroll" data-target=".js-scrollspy">
		
	<div class="offcanvas visible-xs">
		<ul class="offcanvas__nav">
			
				<li><a href="/">Home</a></li>
			
				<li><a href="/schedule">Schedule</a></li>
			
		</ul><!-- /.offcanvas__nav -->
	</div><!-- /.offcanvas -->



	<header class="site-header">
      <!--  <a href="https://github.com/qosf/qosf.org"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub"></a>
 -->
		<div class="container">
			<div class="row">
				<div class="col-xs-12">
					
						<a href="/" class="site-header__logo">
                            <img src="/assets/img/logos/qosf_colour_logo.svg">
						</a><!-- /.site-header__logo -->
					
					
						<ul class="site-header__nav hidden-xs">
							
								<li><a href="/">Home</a></li>
							
								<li><a href="/schedule">Schedule</a></li>
							
						</ul><!-- /.site-header__nav -->
						<button class="offcanvas-toggle visible-xs">
							<span></span>
							<span></span>
							<span></span>
						</button><!-- /.offcanvas-toggle -->
					
				</div><!-- /.col -->
			</div><!-- /.row -->
		</div><!-- /.container -->
	</header><!-- /.site-header -->


		<div class="hero-subheader">
            
            
            
			<div class="container">
				<div class="row">
					<div class="col-md-7">
						<div class="align-container" data-mh>
							<div class="align-inner">
								
								
                                
							</div><!-- /.align-inner -->
						</div><!-- /.align-container -->
					</div><!-- /.col -->
					
				</div><!-- /.row -->
			</div><!-- /.container -->
		</div><!-- /.hero-subheader -->
		<div class="section">
			<div class="container">
				<div class="row">
					<div class="col-md-7">
						<div class="content">
							<!-- render("anova.Rmd", md_document()) -->

<p>Find <a href="https://teachresources.github.io/RPP/u7/anova.Rmd">here</a> the
correspondent <code class="language-plaintext highlighter-rouge">*Rmd</code>.</p>

<h1 id="data-analysis">Data Analysis</h1>

<h1 id="descriptive-statistics-and-graphics">Descriptive Statistics and Graphics</h1>

<h2 id="descritive-analysis">Descritive Analysis</h2>

<p>Descriptive statistics give you a meaningful, quantitative overview over
your sample and helps you summarizing an overwhelming amount of data
into something somehow more comprehensible. It is generally a first step
into statistical analysis, even though it only reflects what your data
are made of.</p>

<h2 id="import-the-data-into-r">Import the data into R</h2>

<p>Prepare your data and import it into R with one of the following
examples or others functions as you desire.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>read.table(file, header = FALSE, sep = "", dec = ".")
read.csv(file, header = TRUE, sep = ",", dec = ".", ...)
read.delim(file, header = TRUE, sep = "\t", dec = ".", ...)
</code></pre></div></div>

<p>For this tutorial, we are generating a fake data set from 5 treatment
groups.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set.seed(123)
# create five treatments with different means 
treatA &lt;- rnorm(50, mean=15, sd=2)
treatB &lt;- rnorm(50, mean=8.5, sd=1)
treatC &lt;- rnorm(50, mean=2, sd=2)
treatD &lt;- rnorm(50, mean=0.53, sd=1)
treatE &lt;- rnorm(50, mean=8.5, sd=2)

# make a blank data frame 
a_data &lt;- data.frame(treat=character(250), A=numeric(250)) 

# populate the data frame
a_data$treat &lt;- c(rep("Control",50), rep("-0.5MPa",50), rep("-1.0MPa",50), rep("-1.5MPa",50), rep("Recover",50))
a_data$A &lt;- c(treatA, treatB, treatC, treatD, treatE)
tibble::tibble(a_data)

## # A tibble: 250 x 2
##    treat       A
##    &lt;chr&gt;   &lt;dbl&gt;
##  1 Control  13.9
##  2 Control  14.5
##  3 Control  18.1
##  4 Control  15.1
##  5 Control  15.3
##  6 Control  18.4
##  7 Control  15.9
##  8 Control  12.5
##  9 Control  13.6
## 10 Control  14.1
## # … with 240 more rows
</code></pre></div></div>

<h2 id="check-your-data">Check your data</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tibble::tibble(a_data)

## # A tibble: 250 x 2
##    treat       A
##    &lt;chr&gt;   &lt;dbl&gt;
##  1 Control  13.9
##  2 Control  14.5
##  3 Control  18.1
##  4 Control  15.1
##  5 Control  15.3
##  6 Control  18.4
##  7 Control  15.9
##  8 Control  12.5
##  9 Control  13.6
## 10 Control  14.1
## # … with 240 more rows

head(a_data)

##     treat  A
## 1 Control 14
## 2 Control 15
## 3 Control 18
## 4 Control 15
## 5 Control 15
## 6 Control 18
</code></pre></div></div>

<h2 id="load-libraries">Load libraries</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>library(viridis)
library(tidyverse)
library(hrbrthemes)
library(ggsn)
library(extrafont)
library(agricolae)
</code></pre></div></div>

<h2 id="functions-in-r">Functions in R</h2>

<p>Some R functions for computing descriptive statistics:</p>

<table>
<thead>
<tr class="header">
<th>Description</th>
<th>R function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mean</td>
<td>mean()</td>
</tr>
<tr class="even">
<td>Standard deviation</td>
<td>sd()</td>
</tr>
<tr class="odd">
<td>Variance</td>
<td>var()</td>
</tr>
<tr class="even">
<td>Minimum</td>
<td>min()</td>
</tr>
<tr class="odd">
<td>Maximum</td>
<td>max()</td>
</tr>
<tr class="even">
<td>Median</td>
<td>median()</td>
</tr>
<tr class="odd">
<td>Sample quantiles</td>
<td>quantile()</td>
</tr>
<tr class="even">
<td>Generic function</td>
<td>summary()</td>
</tr>
</tbody>
</table>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>stats &lt;- a_data %&gt;%
  group_by(treat) %&gt;%
  summarise(
    n = n(), ## check missing values
    mean = mean(A),
    sd = sd(A), ## Standard deviation
    se = sd/sqrt(n), ## Standard error (sd(x)/sqrt(length(x)))
    var= var(A), 
    min = min(A), 
    max = max(A), 
    median= median(A))

stats 

## # A tibble: 5 x 9
##   treat       n   mean    sd    se   var    min   max
##   &lt;chr&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 -0.5MPa    50  8.65  0.905 0.128 0.820  6.19  10.7 
## 2 -1.0MPa    50  1.49  1.98  0.280 3.92  -2.11   6.20
## 3 -1.5MPa    50  0.569 0.931 0.132 0.867 -0.781  3.77
## 4 Control    50 15.1   1.85  0.262 3.43  11.1   19.3 
## 5 Recover    50  8.48  1.89  0.268 3.59   5.78  12.9 
## # … with 1 more variable: median &lt;dbl&gt;

quantile(a_data$A)

##   0%  25%  50%  75% 100% 
## -2.1  1.2  7.5 10.0 19.3

summary(a_data)

##     treat                 A       
##  Length:250         Min.   :-2.1  
##  Class :character   1st Qu.: 1.2  
##  Mode  :character   Median : 7.5  
##                     Mean   : 6.9  
##                     3rd Qu.:10.0  
##                     Max.   :19.3
</code></pre></div></div>

<h1 id="visualization">Visualization</h1>

<h2 id="histogram">Histogram</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hist(a_data$A)
</code></pre></div></div>

<p><img src="/u7/anova_files/figure-markdown_strict/unnamed-chunk-6-1.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hist(a_data$A[1:50])
</code></pre></div></div>

<p><img src="/u7/anova_files/figure-markdown_strict/unnamed-chunk-6-2.png" alt="" /></p>

<h3 id="ggplot2">ggplot2</h3>

<p>Code from here
<a href="https://www.r-graph-gallery.com/histogram_several_group.html">ggplot2</a></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p &lt;- a_data %&gt;%
  mutate(treat = fct_reorder(treat, A)) %&gt;%
  ggplot( aes(x=A, color=treat, fill=treat)) +
    geom_histogram(alpha=0.6, binwidth = 5) +
    scale_fill_viridis(discrete=TRUE) +
    scale_color_viridis(discrete=TRUE) +
    theme_ipsum() +
    theme(
      legend.position="none",
      panel.spacing = unit(0.1, "lines")) +
    xlab("") +
    ylab("Treatment") +
    facet_wrap(~treat)
print(p)
</code></pre></div></div>

<p><img src="/u7/anova_files/figure-markdown_strict/unnamed-chunk-7-1.png" alt="" /></p>

<h2 id="barplot">Barplot</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>barplot(stats$mean, main="Means", xlab="Number of Gears", names.arg=stats$treat)
</code></pre></div></div>

<p><img src="/u7/anova_files/figure-markdown_strict/unnamed-chunk-8-1.png" alt="" /></p>

<h3 id="ggplot2-1">ggplot2</h3>

<p>Code from here
<a href="https://www.r-graph-gallery.com/89-box-and-scatter-plot-with-ggplot2.html">ggplot2</a></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p &lt;- ggplot(stats, aes(x=treat, y=mean, fill=treat )) + 
   geom_bar(stat="identity") +
  theme(legend.position="none")
p + scale_fill_grey()
</code></pre></div></div>

<p><img src="/u7/anova_files/figure-markdown_strict/unnamed-chunk-9-1.png" alt="" /></p>

<h2 id="box-plots">Box plots</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>boxplot(a_data$A[1:50])
</code></pre></div></div>

<p><img src="/u7/anova_files/figure-markdown_strict/unnamed-chunk-10-1.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p &lt;- a_data %&gt;%
   ggplot( aes(x=treat, y=A, fill=treat)) +
    geom_boxplot() +
    scale_fill_viridis(discrete = TRUE, alpha=0.6) +
    geom_jitter(color="black", size=0.4, alpha=0.9) +
    theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    ggtitle("Treatments") +
    xlab("")
print(p)
</code></pre></div></div>

<p><img src="/u7/anova_files/figure-markdown_strict/unnamed-chunk-11-1.png" alt="" /></p>

<h1 id="t-tests-one-and-two-sample"><em>t</em>-tests: One and Two-sample</h1>

<h2 id="overview">Overview</h2>

<p><em>t</em>-tests in R are relatively simple to use and only require one or two
vectors of numerical data (depending on if it is a one or two-sample
t-test) in order for the analysis to run. Below is an example of the R
t-test code:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Dummy t-test code
t.test(x, y = NULL, alternative = c("two.sided", "less", "greater"), mu = 0, paired =
FALSE, var.equal = FALSE, conf.level = 0.95)
</code></pre></div></div>

<p>The parameters of the <em>t</em>-test are simple to set. <code class="language-plaintext highlighter-rouge">x</code> is a numeric
vector of data while <code class="language-plaintext highlighter-rouge">y</code> is an additional numeric vector of data that
you want to compare to <code class="language-plaintext highlighter-rouge">x</code>, although it is not required for the test.
When running <code class="language-plaintext highlighter-rouge">t.test</code>, the default value for <code class="language-plaintext highlighter-rouge">y</code> is <code class="language-plaintext highlighter-rouge">NULL.</code> If you only
specify x, it will run a one-sample <em>t</em>-test. Specifying <code class="language-plaintext highlighter-rouge">y</code> will
override the default value and run a two-sample <em>t</em>-test.</p>

<p>The other parameters of <code class="language-plaintext highlighter-rouge">t.test</code> are also important:</p>

<ul>
  <li>By default, R will run each <em>t</em>-test as a two-tailed test, as
indicated by “two.sided” in the alternative parameter. You can
override this by specifying “less” or “greater”, which will run the
analysis as a one-tailed <em>t</em>-test with the criterion being located
at the lower or upper regions of the distribution, respectively.</li>
  <li>R also defaults to a 95% confidence level (<em>α</em> = 0.05). Specifying a
custom value in <code class="language-plaintext highlighter-rouge">conf.level</code> will set a new confidence level in the
<em>t</em>-test.</li>
  <li>If you would like to indicate that the test is a paired-samples
<em>t</em>-test (which R does not automatically assume), you can specify
<code class="language-plaintext highlighter-rouge">paired = TRUE</code>.</li>
  <li>You can manually indicate the true value of the mean by specifying a
custom value in <code class="language-plaintext highlighter-rouge">mu.</code> For two-sample <em>t</em>-tests, this will set the
true difference of the two means to the specified value. The null
value for <code class="language-plaintext highlighter-rouge">mu</code> is zero, i.e. the difference in the means of the two
sets of data is zero.</li>
  <li>Finally, <code class="language-plaintext highlighter-rouge">var.equal</code> allows you to specify whether two sets of data
have equal variance or not. (Note that this is only for two-sample
<em>t</em>-tests.) The default value is FALSE, which assumes inequal
variance between datasets and uses the Welch approximation for
degrees of freedom. Specifying <code class="language-plaintext highlighter-rouge">var.equal = TRUE</code> will estimate
variance using pooled variance.</li>
</ul>

<h2 id="one-sample-t-test">One-sample <em>t</em>-test</h2>

<p>One-sample <em>t</em>-test is used to compare the mean of one sample to a known
standard (or theoretical/hypothetical) mean (μ).</p>

<ul>
  <li><em>Note that, one-sample t-test can be used only, when the data are
normally distributed.</em></li>
</ul>

<h3 id="research-questions-and-statistical-hypotheses">Research questions and statistical hypotheses</h3>

<p>Typical research questions are:</p>

<ul>
  <li>whether the mean (<code class="language-plaintext highlighter-rouge">m</code>) of the sample is equal to the theoretical
mean (<code class="language-plaintext highlighter-rouge">μ</code>)?</li>
  <li>whether the mean (<code class="language-plaintext highlighter-rouge">m</code>) of the sample is less than the theoretical
mean (<code class="language-plaintext highlighter-rouge">μ</code>)?</li>
  <li>whether the mean (<code class="language-plaintext highlighter-rouge">m</code>) of the sample is greater than the theoretical
mean (<code class="language-plaintext highlighter-rouge">μ</code>)?</li>
</ul>

<p>In statistics, we can define the corresponding null <em>hypothesis</em> (<code class="language-plaintext highlighter-rouge">H0</code>)
as follow:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">H0: m = μ</code></li>
  <li><code class="language-plaintext highlighter-rouge">H0: m ≤ μ</code></li>
  <li><code class="language-plaintext highlighter-rouge">H0: m ≥ μ</code></li>
</ul>

<p>The corresponding alternative hypotheses (H<em>α</em>) are as follow:</p>

<ul>
  <li>H<em>α</em>: <code class="language-plaintext highlighter-rouge">m ≠ μ</code> (different)</li>
  <li>H<em>α</em>: <code class="language-plaintext highlighter-rouge">m &gt; μ</code> (greater)</li>
  <li>H<em>α</em>: <code class="language-plaintext highlighter-rouge">m &lt; μ</code> (less)</li>
</ul>

<p>Note that:</p>

<ul>
  <li>Hypotheses 1) are called <code class="language-plaintext highlighter-rouge">two-tailed</code> tests</li>
  <li>Hypotheses 2) and 3) are called <code class="language-plaintext highlighter-rouge">one-tailed</code> tests</li>
</ul>

<h3 id="formula-of-one-sample-t-test">Formula of one-sample t-test</h3>

<p>The <em>t</em>-statistic can be calculated as follow:</p>

<p>$t = \frac{m − μ}{s / \sqrt{n}}$</p>

<p>where,</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">m</code> is the sample mean</li>
  <li><code class="language-plaintext highlighter-rouge">n</code> is the sample size</li>
  <li><code class="language-plaintext highlighter-rouge">s</code> is the sample standard deviation with <code class="language-plaintext highlighter-rouge">n−1</code> degrees of freedom</li>
  <li><code class="language-plaintext highlighter-rouge">μ</code> is the theoretical value</li>
</ul>

<p>We can compute the <code class="language-plaintext highlighter-rouge">p-value</code> corresponding to the absolute value of the
<code class="language-plaintext highlighter-rouge">t-test</code> statistics (|t|) for the degrees of freedom <code class="language-plaintext highlighter-rouge">(df): df=n−1</code>.</p>

<p>How to interpret the results?</p>

<p>If the <code class="language-plaintext highlighter-rouge">p-value</code> is inferior or equal to the significance level<code class="language-plaintext highlighter-rouge">0.05</code>,
we can reject the null hypothesis and accept the alternative hypothesis.
In other words, we conclude that the sample mean is significantly
different from the theoretical mean.</p>

<h3 id="t-test"><em>t</em>-test</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>t.test(x=a_data$A[1:50])

## 
##  One Sample t-test
## 
## data:  a_data$A[1:50]
## t = 58, df = 49, p-value &lt;2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  15 16
## sample estimates:
## mean of x 
##        15

t.test(x=a_data$A[1:50], y = NULL, alternative = c("two.sided"),
       mu = 0, paired = FALSE, var.equal = FALSE, conf.level = 0.95)

## 
##  One Sample t-test
## 
## data:  a_data$A[1:50]
## t = 58, df = 49, p-value &lt;2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  15 16
## sample estimates:
## mean of x 
##        15

t.test(x=a_data$A[1:50], mu = 20, alternative = "less")

## 
##  One Sample t-test
## 
## data:  a_data$A[1:50]
## t = -19, df = 49, p-value &lt;2e-16
## alternative hypothesis: true mean is less than 20
## 95 percent confidence interval:
##  -Inf   16
## sample estimates:
## mean of x 
##        15

t.test(x=a_data$A[1:50], mu = 20, alternative = "greater")

## 
##  One Sample t-test
## 
## data:  a_data$A[1:50]
## t = -19, df = 49, p-value = 1
## alternative hypothesis: true mean is greater than 20
## 95 percent confidence interval:
##   15 Inf
## sample estimates:
## mean of x 
##        15
</code></pre></div></div>

<h2 id="two-sample-t-test-for-independent-samples">Two-sample <em>t</em>-test for <strong>independent</strong> samples</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tibble(a_data)

## # A tibble: 250 x 2
##    treat       A
##    &lt;chr&gt;   &lt;dbl&gt;
##  1 Control  13.9
##  2 Control  14.5
##  3 Control  18.1
##  4 Control  15.1
##  5 Control  15.3
##  6 Control  18.4
##  7 Control  15.9
##  8 Control  12.5
##  9 Control  13.6
## 10 Control  14.1
## # … with 240 more rows

a_test &lt;- a_data[1:100,] ## selection Control and -0.5MPa
</code></pre></div></div>

<h3 id="hypothesis"><em>Hypothesis:</em></h3>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">H0: μchange2 = μchange1</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">H$\alpha$: μchange2 &gt; μchange1</code></p>
  </li>
</ul>

<p>Or:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">HO: μchange2 − μchange1 = 0</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">H$\alpha$: μchange2 − μchange1 &gt; 0</code></p>
  </li>
</ul>

<!-- -->

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>t.test(A ~ treat, paired=FALSE, data=a_test)

## 
##  Welch Two Sample t-test
## 
## data:  A by treat
## t = -22, df = 71, p-value &lt;2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -7.0 -5.8
## sample estimates:
## mean in group -0.5MPa mean in group Control 
##                   8.6                  15.1
</code></pre></div></div>

<h2 id="two-sample-t-test-for-dependent-samples">Two-sample <em>t</em>-test for <strong>dependent</strong> samples</h2>

<h3 id="hypothesis-1"><em>Hypothesis:</em></h3>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">HO: μchange2 − μchange1 = 0</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">H$\alpha$: μchange2 − μchange1 &gt; 0</code></p>
  </li>
</ul>

<!-- -->

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>t.test(A ~ treat, paired=TRUE, data=a_test)

## 
##  Paired t-test
## 
## data:  A by treat
## t = -22, df = 49, p-value &lt;2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -7.0 -5.8
## sample estimates:
## mean of the differences 
##                    -6.4
</code></pre></div></div>

<h1 id="analysis-of-variance-anova">ANalysis Of VAriance (ANOVA)</h1>

<p>Analysis of variance (ANOVA) is used to compare the means of more than 2
groups. Unsurprisingly, the way ANOVA works is by comparing variances.
Variables must be categorical, and will often be called factors. There
are several designs for ANOVA, depending on the number of variables to
be compared and on whether samples are measured several times during the
course of an experiment. In this section, we’ll talk about:</p>

<ul>
  <li>one-way ANOVA (1 single variable/factor with more than 2 levels),</li>
  <li>two-way ANOVA (factorial design - 2 or more factors with 2 or more
levels each)</li>
</ul>

<h2 id="fit-a-model">Fit a Model</h2>

<p>In the following examples lower case letters are numeric variables and
upper case letters are factors.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># One Way Anova (Completely Randomized Design)
fit &lt;- aov(y ~ A, data=mydataframe)

# Randomized Block Design (B is the blocking factor)
fit &lt;- aov(y ~ A + B, data=mydataframe)

# Two Way Factorial Design
fit &lt;- aov(y ~ A + B + A:B, data=mydataframe)
fit &lt;- aov(y ~ A*B, data=mydataframe) # same thing
</code></pre></div></div>

<h2 id="one-way-anova-test">One-way ANOVA test</h2>

<p>The one-way analysis of variance (ANOVA), also known as one-factor
ANOVA, is an extension of independent two-samples t-test for comparing
means in a situation where there are more than two groups. In one-way
ANOVA, the data is organized into several groups base on one single
grouping variable (also called factor variable). This tutorial describes
the basic principle of the one-way ANOVA test and provides practical
anova test examples in R software.</p>

<p>ANOVA test hypotheses:</p>

<ul>
  <li>Null hypothesis: the means of the different groups are the same</li>
  <li>Alternative hypothesis: At least one sample mean is not equal to the
others.</li>
</ul>

<h3 id="import-and-check-your-data-into-r">Import and check your data into R</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tibble(a_data)

## # A tibble: 250 x 2
##    treat       A
##    &lt;chr&gt;   &lt;dbl&gt;
##  1 Control  13.9
##  2 Control  14.5
##  3 Control  18.1
##  4 Control  15.1
##  5 Control  15.3
##  6 Control  18.4
##  7 Control  15.9
##  8 Control  12.5
##  9 Control  13.6
## 10 Control  14.1
## # … with 240 more rows
</code></pre></div></div>

<h3 id="compute-one-way-anova-test">Compute one-way ANOVA test</h3>

<p>We want to know if there is any significant difference between the
average photosynthesis of plants in the 5 experimental conditions.</p>

<p>The R function <code class="language-plaintext highlighter-rouge">aov()</code> can be used to answer to this question. The
function <code class="language-plaintext highlighter-rouge">summary.aov()</code> is used to summarize the analysis of variance
model.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Compute the analysis of variance
res.aov &lt;- aov(A ~ treat, data = a_data)
# Summary of the analysis
summary(res.aov)

##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## treat         4   7080    1770     701 &lt;2e-16 ***
## Residuals   245    618       3                   
## ---
## Signif. codes:  
## 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</code></pre></div></div>

<p>The output includes the columns <code class="language-plaintext highlighter-rouge">F value</code> and <code class="language-plaintext highlighter-rouge">Pr(&gt;F)</code> corresponding to
the <code class="language-plaintext highlighter-rouge">p-value</code> of the test.</p>

<h2 id="two-way-anova-test">Two-way ANOVA test</h2>

<p>Two-way ANOVA test is used to evaluate simultaneously the effect of two
grouping variables (A and B) on a response variable.</p>

<p>The grouping variables are also known as factors. The different
categories (groups) of a factor are called levels. The number of levels
can vary between factors. The level combinations of factors are called
cell.</p>

<h3 id="two-way-anova-test-hypotheses">Two-way ANOVA test hypotheses</h3>

<ul>
  <li>There is no difference in the means of factor A</li>
  <li>There is no difference in means of factor B</li>
  <li>There is no interaction between factors A and B</li>
  <li>The alternative hypothesis for cases 1 and 2 is: the means are not
equal.</li>
  <li>The alternative hypothesis for case 3 is: there is an interaction
between A and B.</li>
</ul>

<blockquote>
  <p>Two-way ANOVA, like all ANOVA tests, assumes that the observations
within each cell are normally distributed and have equal variances.
We’ll show you how to check these assumptions after fitting ANOVA.</p>
</blockquote>

<h3 id="import-and-check-your-data-into-r-1">Import and check your data into R</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>my_data &lt;- ToothGrowth
tibble(my_data)

## # A tibble: 60 x 3
##      len supp   dose
##    &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt;
##  1   4.2 VC      0.5
##  2  11.5 VC      0.5
##  3   7.3 VC      0.5
##  4   5.8 VC      0.5
##  5   6.4 VC      0.5
##  6  10   VC      0.5
##  7  11.2 VC      0.5
##  8  11.2 VC      0.5
##  9   5.2 VC      0.5
## 10   7   VC      0.5
## # … with 50 more rows

my_data$dose &lt;- factor(my_data$dose, 
                  levels = c(0.5, 1, 2),
                  labels = c("D0.5", "D1", "D2"))
head(my_data)

##    len supp dose
## 1  4.2   VC D0.5
## 2 11.5   VC D0.5
## 3  7.3   VC D0.5
## 4  5.8   VC D0.5
## 5  6.4   VC D0.5
## 6 10.0   VC D0.5

table(my_data$supp, my_data$dose)

##     
##      D0.5 D1 D2
##   OJ   10 10 10
##   VC   10 10 10
</code></pre></div></div>

<p>We have 2X3 design cells with the factors being supp and dose and 10
subjects in each cell. Here, we have a balanced design. In the next
sections I’ll describe how to analyse data from balanced designs, since
this is the simplest case.</p>

<h3 id="compute-two-way-anova-test">Compute two-way ANOVA test</h3>

<p>We want to know if tooth length depends on supp and dose.</p>

<p>The R function <code class="language-plaintext highlighter-rouge">aov()</code> can be used to answer this question. The
function<code class="language-plaintext highlighter-rouge">summary.aov()</code>is used to summarize the analysis of variance
model.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Compute the analysis of variance
res.aov2 &lt;- aov(len ~ supp + dose, data = my_data)
# Summary of the analysis
summary(res.aov2)

##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## supp         1    205     205    14.0 0.00043 ***
## dose         2   2426    1213    82.8 &lt; 2e-16 ***
## Residuals   56    820      15                    
## ---
## Signif. codes:  
## 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</code></pre></div></div>

<p>The output includes the columns <code class="language-plaintext highlighter-rouge">F value</code> and <code class="language-plaintext highlighter-rouge">Pr(&gt;F)</code> corresponding to
the <code class="language-plaintext highlighter-rouge">p-value</code> of the test. From the ANOVA table we can conclude that
both supp and dose are statistically significant. dose is the most
significant factor variable. These results would lead us to believe that
changing delivery methods (supp) or the dose of vitamin C, will impact
significantly the mean tooth length.</p>

<blockquote>
  <p>Not the above fitted model is called additive model. It makes an
assumption that the two factor variables are independent. If you think
that these two variables might interact to create an synergistic
effect, replace the plus symbol (+) by an asterisk (*), as follow.</p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Two-way ANOVA with interaction effect
# These two calls are equivalent
res.aov3 &lt;- aov(len ~ supp * dose, data = my_data)
res.aov3 &lt;- aov(len ~ supp + dose + supp:dose, data = my_data)
summary(res.aov3)

##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## supp         1    205     205   15.57 0.00023 ***
## dose         2   2426    1213   92.00 &lt; 2e-16 ***
## supp:dose    2    108      54    4.11 0.02186 *  
## Residuals   54    712      13                    
## ---
## Signif. codes:  
## 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

print(TukeyHSD(res.aov3,"dose"))

##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = len ~ supp + dose + supp:dose, data = my_data)
## 
## $dose
##         diff  lwr  upr p adj
## D1-D0.5  9.1  6.4 11.9     0
## D2-D0.5 15.5 12.7 18.3     0
## D2-D1    6.4  3.6  9.1     0

print(TukeyHSD(res.aov3,"supp"))

##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = len ~ supp + dose + supp:dose, data = my_data)
## 
## $supp
##       diff  lwr  upr p adj
## VC-OJ -3.7 -5.6 -1.8     0
</code></pre></div></div>

<p>It can be seen that the two main effects (supp and dose) are
statistically significant, as well as their interaction.</p>

<p>Note that, in the situation where the interaction is not significant you
should use the additive model.</p>

<h3 id="interpret-the-results">Interpret the results</h3>

<p>From the ANOVA results, you can conclude the following, based on the
p-values and a significance level of 0.05:</p>

<ul>
  <li>the p-value of supp is 0.000429 (significant), which indicates that
the levels of supp are associated with significant different tooth
length.</li>
  <li>the p-value of dose is &lt; 2e-16 (significant), which indicates
that the levels of dose are associated with significant different
tooth length.</li>
  <li>the p-value for the interaction between supp*dose is 0.02
(significant), which indicates that the relationships between dose
and tooth length depends on the supp method.</li>
</ul>

<h3 id="check-the-normality-assumpttion">Check the normality assumpttion</h3>

<p><em>Normality plot of the residuals</em>. In the plot below, the quantiles of
the residuals are plotted against the quantiles of the normal
distribution. A 45-degree reference line is also plotted. The normal
probability plot of residuals is used to verify the assumption that the
residuals are normally distributed. The normal probability plot of the
residuals should approximately follow a straight line.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>plot(res.aov3, 2)
</code></pre></div></div>

<p><img src="/u7/anova_files/figure-markdown_strict/unnamed-chunk-25-1.png" alt="" /></p>

<p>As all the points fall approximately along this reference line, we can
assume normality.</p>

<p>The conclusion above, is supported by the Shapiro-Wilk test on the ANOVA
residuals (W = 0.98, p = 0.5) which finds no indication that normality
is violated.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Extract the residuals
aov_residuals &lt;- residuals(object = res.aov3)
# Run Shapiro-Wilk test
shapiro.test(x = aov_residuals )

## 
##  Shapiro-Wilk normality test
## 
## data:  aov_residuals
## W = 1, p-value = 0.7
</code></pre></div></div>

<h1 id="multiple-comparisons-with-agricolae-package">Multiple comparisons with <code class="language-plaintext highlighter-rouge">agricolae</code> Package</h1>

<p><a href="https://cran.r-project.org/web/packages/agricolae/vignettes/tutorial.pdf">Source</a></p>

<blockquote>
  <p>Live demo</p>
</blockquote>

<h1 id="the-tukey-test-with-multcompview-package">The Tukey test with <code class="language-plaintext highlighter-rouge">multcompView</code> package</h1>

<p>In R, the <code class="language-plaintext highlighter-rouge">multcompView</code> allows to run the Tukey test thanks to the
<code class="language-plaintext highlighter-rouge">TukeyHSD()</code> function. It also offers a chart that shows the mean
difference for each pair of group.</p>

<p>Code from <a href="https://www.r-graph-gallery.com/84-tukey-test.html">here</a>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># library
library(multcompView)
library(ggplot2)
library(plyr)

set.seed(0)
lev &lt;- gl(3, 10)
y &lt;- c(rnorm(10), rnorm(10) + 0.1, rnorm(10) + 3)
d &lt;- data.frame(lev=lev, y=y)

a &lt;- aov(y~lev, data=d)
tHSD &lt;- TukeyHSD(a, ordered = FALSE, conf.level = 0.95)
</code></pre></div></div>

<h2 id="tukey-test-result-on-top-of-boxplot">Tukey test result on top of boxplot</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>generate_label_df &lt;- function(HSD, flev){
 # Extract labels and factor levels from Tukey post-hoc 
 Tukey.levels &lt;- HSD[[flev]][,4]
 Tukey.labels &lt;- multcompLetters(Tukey.levels)['Letters']
 plot.labels &lt;- names(Tukey.labels[['Letters']])

 # Get highest quantile for Tukey's 5 number summary and add a bit of space to buffer between    
 # upper quantile and label placement
    boxplot.df &lt;- ddply(d, flev, function (x) max(fivenum(x$y)) + 0.2)

 # Create a data frame out of the factor levels and Tukey's homogenous group letters
  plot.levels &lt;- data.frame(plot.labels, labels = Tukey.labels[['Letters']],
     stringsAsFactors = FALSE)

 # Merge it with the labels
   labels.df &lt;- merge(plot.levels, boxplot.df, by.x = 'plot.labels', by.y = flev, sort = FALSE)

return(labels.df)
}

p_base &lt;- ggplot(d, aes(x=lev, y=y)) + geom_boxplot() +
  geom_text(data = generate_label_df(tHSD, 'lev'), aes(x = plot.labels, y = V1, label = labels))
p_base
</code></pre></div></div>

<p><img src="/u7/anova_files/figure-markdown_strict/unnamed-chunk-28-1.png" alt="" /></p>

<h1 id="reference">Reference:</h1>

<ol>
  <li><a href="http://www.sthda.com/english/wiki/one-way-anova-test-in-r">One-Way ANOVA Test in
R</a></li>
  <li><a href="http://www.sthda.com/english/wiki/two-way-anova-test-in-r">Two-Way ANOVA Test in
R</a></li>
  <li><a href="https://cran.r-project.org/web/packages/agricolae/vignettes/tutorial.pdf">agricolae
Package</a></li>
</ol>

						</div><!-- /.content -->
					</div><!-- /.col -->
					<div class="col-md-4 col-md-offset-1">
						<div class="sections-list-wrapper">
							<div class="sections-list js-sections js-affix js-scrollspy hidden-xs hidden-sm"></div><!-- /.sections-list -->
						</div>
					</div><!-- /.col -->
				</div><!-- /.row -->
			</div><!-- /.container -->
		</div><!-- /.section -->
		
		<div class="js-footer-area">
			
			
			
	<footer class="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-sm-6">
					
						<a href="/" class="site-footer__logo">R for Plant Physiologists</a>
					
					
						<hr>
						<p class="site-footer__copyright">Contact: <a href="mailto:danicassol@gmail.com">danicassol@gmail.com</a> </br> ©2020 Daniela Cassol. All rights reserved.</p>
					
				</div><!-- /.col -->
				
					<div class="col-sm-6 align-right">
						<ul class="social-list">
							
								<li>
									<a href="https://www.github.com/dcassol" target="_blank" class="social-list__item social-list__item--github">
										<i class="icon icon--github"></i>
									</a>
								</li>
							
						</ul><!-- /.social-list -->
					</div><!-- /.col -->
				
			</div><!-- /.row -->
		</div><!-- /.container -->
	</footer><!-- /.site-footer -->


<script src="/doks-theme/assets/js/vendor/jquery.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/vendor/bootstrap/affix.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/vendor/bootstrap/scrollspy.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/vendor/matchHeight.min.js"></script>
<script type="text/javascript" src="/doks-theme/assets/js/scripts.min.js"></script>




		</div><!-- /.js-footer-area -->
	</body>
</html>
